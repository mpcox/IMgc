# IMgc

*IMgc* reads in an aligned FASTA file, and finds and returns the largest non-recombining block of DNA sequence. This is necessary for downstream analyses that require datasets containing no evidence of recombination. *IMgc* maximizes the amount of information (as defined by the user) in the final dataset. Specifically, the user can favour retention of segregating sites versus individuals. The default is equal weighting of individuals and segregating sites.

*IMgc* was developed and reported in:

Woerner AE, MP Cox and MF Hammer. 2007. [Recombination-filtered genomic datasets by information maximization](https://doi.org/10.1093/bioinformatics/btm253). *Bioinformatics* 23: 1851-1853.

When running *IMgc*, the software first identifies segregating sites (we currently include indels in this definition). Sequence data must be haplotypic and fully phased (*i.e.*, no ambiguity codes are allowed). The following characters are permitted:

```
GATCN–
```

where *N* signifies missing data and – indicates an indel.

Complex multi-base indels are sometimes observed; for instance:

```
ATT --T --- ATT --T
```

*IMgc* treats adjacent indels as a single unit.  For infinite sites violations, *IMgc* currently changes all but the two highest frequency character states at a site violating the infinite sites model to *N*. For instance, if the three adjacent indels are infinite site violations, the example above becomes:

```
ATT -T NNN ATT -T
```


INSTALLATION

*IMgc* requires a standard working Perl installation and has been confirmed to work with Perl versions up to 5.18.2.


USAGE

Assuming a standard installation (*i.e.,* with *IMGC.pl* aliased to *IMgc*), usage information can be found by running the command:

```
IMgc --help
```

The basic usage is:

```
IMgc FASTA_file(s)
```

There are, however, a number of user options that can be set:

```
-w    removes individuals; maintains original sequence length (fast)
-s    removes both individuals and sites; makes the largest block possible (slow)
-i #  weights keeping individuals versus keeping sites (default 1.1)
-o #  omits the nth ID from the FASTA file, but tacks them back on in the output (default 0)
-p #  preserves the nth ID from the FASTA file no matter what (default 0)
-f    prints output in FASTA format, not IM format
```


EXAMPLE






The following command line simulates 3 datasets, each containing 10 chromosome copies, with the first 6 copies deriving from group 1 and the remaining 4 copies from group 2:

```
ms 10 3 -t 5 -I 2 6 4 1 -T | mstree -g1 6 -g2 4
```

The coalescent genealogies generated by *ms* are of course random, but the output formatting looks like the following, with each line containing summaries for a single input dataset:

```
pmc    tmrca
0.33333    1.691
0.42857    0.903
0.00000    4.653
```
